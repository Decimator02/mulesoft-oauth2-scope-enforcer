#
# Copyright (c) 2017 The Trustees of Columbia University in the City of New York
# Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
# except in compliance with the License. You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
# implied. See the License for the specific language governing
# permissions and limitations under the License.
#
name: OAuth 2.0 Scope Enforcement Policy
description: |
  Validates OAuth 2.0 required scopes for each method:resource.
  Enter methods in lowercase and resources as defined in the API.
  For example: `get:/things`
  Enter scopes as a space-separated list.
  For example: `read foobar`
id: oauth2-scope-enforcer
# new feature as of 3.8.x: resource-level policy
resourceLevelSupported: true
providedCharacteristics:
  - OAuth 2.0 scope enforcement
requiredCharacteristics:
  - OAuth 2.0 protected
requiresConnectivity: true
standalone: true
type: custom
category: Security
configuration:
  - propertyName: scopeMap
    name: scopeMap
    description: Names of methods:resources and required scopes
    sensitive: false
    type: keyvalues
    optional: false
    allowMultiple: true
  